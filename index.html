<!doctype html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>RSF - Dashboard</title><link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
<link rel="shortcut icon" href="assets/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
<link rel="manifest" href="assets/site.webmanifest">
<link rel="stylesheet" href="assets/style.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet"></head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-pz6+0j6qf6g2wY1nQbqZfOaUe3z0h3mU6pyw1oE6m+VJ4k9b5eM8hQ8C7Yy7wJ1Ia6pVt+F2R4H1QeIw4M0agA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<body><header class="topbar">
  <div class="brand">
    <div class="logo" id="logo-container"></div>
    <h1 data-i18n="brand">RESTAURANTES SIN FRONTERAS</h1>
  </div>
  <button id="menu-btn" class="menu-btn" aria-label="Menú" title="Menú">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <nav class="nav" id="main-nav">
    <a href="index.html" data-i18n="nav_dashboard">Dashboard</a>
    <a href="restaurantes.html" data-i18n="nav_restaurants">Restaurantes</a>
    <a href="menus.html" data-i18n="nav_menus">Menús</a>
    <a href="facturacion.html" data-i18n="nav_billing">Facturación</a>
    <a href="reportes.html" data-i18n="nav_reports">Reportes</a>
    <a href="opiniones.html" data-i18n="nav_opinions">Opiniones</a>
    <a href="login.html" data-i18n="login">Login</a>
    <a href="users.html" data-admin-only>Usuarios</a>
  </nav>
  <div class="controls">
    <select id="lang-select" onchange="setLang(this.value)"><option value="es">ES</option><option value="en">EN</option></select>
    <button id="login-btn" onclick="showLogin()" data-i18n="login">Login</button>
    <span id="user-badge" class="user-badge hidden"></span>
  </div>
  <div class="container">
    <div class="dashboard-hero card">
      <div>
        <h2>Panel de control</h2>
        <div class="subtitle">Resumen de operaciones, actividad y KPIs</div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <div class="muted" id="last-updated"></div>
        <button id="update-btn" onclick="updateDashboard()" title="Actualizar" aria-label="Actualizar datos"><i class="fa-solid fa-arrows-rotate"></i> Actualizar</button>
        <button id="export-btn" onclick="exportSalesCSV()" title="Exportar CSV" aria-label="Exportar CSV"><i class="fa-solid fa-file-csv"></i> Exportar</button>
      </div>
    </div>
</div>
</header>
<!-- Script initialization runs after app.js is loaded -->
<main class="container">
  <section class="card kpi-row">
    <div class="kpi">
      <div class="kpi-head"><span class="kpi-title">Restaurantes</span><small class="kpi-sub">Total</small></div>
      <div class="kpi-value"><i class="fa-solid fa-utensils" style="color:#0ea5a4"></i><span id="total-restaurants">0</span><span id="rest-growth" class="kpi-growth"></span></div>
      <div class="kpi-spark"><canvas id="spark-restaurants" width="120" height="36"></canvas></div>
    </div>
    <div class="kpi">
      <div class="kpi-head"><span class="kpi-title">Ventas</span><small class="kpi-sub">Total</small></div>
      <div class="kpi-value"><i class="fa-solid fa-dollar-sign" style="color:#06b6d4"></i><span id="total-sales">0</span><span class="value-compact" id="sales-compact"></span><span id="sales-growth" class="kpi-growth"></span></div>
      <div class="kpi-spark"><canvas id="spark-sales" width="120" height="36"></canvas></div>
    </div>
    <div class="kpi">
      <div class="kpi-head"><span class="kpi-title">Opiniones</span><small class="kpi-sub">Últimas</small></div>
      <div class="kpi-value"><i class="fa-solid fa-star" style="color:#f97316"></i><span id="total-opinions">0</span><span id="opinions-growth" class="kpi-growth"></span></div>
      <div class="kpi-spark"><canvas id="spark-opinions" width="120" height="36"></canvas></div>
    </div>
    <div class="kpi" style="flex-basis:420px;min-width:320px;align-items:flex-end;">
      <div class="kpi-head"><span class="kpi-title">Ventas (Tendencia)</span><small class="kpi-sub">Últimos 7</small></div>
      <div class="chart-wrap" style="width:100%;"><canvas id="salesChart" width="320" height="84"></canvas></div>
      <div style="margin-top:6px;font-size:12px;color:var(--muted)">Rango: <input id="filter-start" type="date"/> - <input id="filter-end" type="date"/> <button onclick="applyFilters()">Aplicar</button> <button onclick="exportSalesCSV()">Exportar CSV</button></div>
    </div>
  </section>

  <section class="card grid two-col">
    <div>
      <div class="card">
        <h3>Actividad reciente</h3>
        <ul id="recent-restaurants" class="recent-list small"></ul>
      </div>
      <div class="card">
        <h3>Top restaurantes por ventas</h3>
        <ul id="top-restaurants" class="top-list small"></ul>
      </div>
      <div class="card">
        <h3 data-i18n="chain_info">Información de la Cadena</h3>
        <label data-i18n="name">Nombre:<input id="chain-name" data-readonly-for-viewer/></label>
        <label data-i18n="desc">Descripción:<input id="chain-desc" data-readonly-for-viewer/></label>
        <div style="display:flex;gap:8px;margin-top:8px"><button onclick="saveChain()" data-readonly-for-viewer>Guardar</button><span class="small muted" id="chain-saved"></span></div>
      </div>
    </div>
    <div>
      <div class="card">
        <h3>Ventas por país (Top 5)</h3>
        <table id="sales-by-country"><tbody></tbody></table>
      </div>
      <div class="card">
        <h3>Promedio de reseñas</h3>
        <div class="rating-row"><div class="avg-rating" id="avg-rating">—</div><div class="rating-stats small" id="rating-stats">—</div></div>
      </div>
    </div>
  </section>
</main>
<footer class="footer">© <span id="year"></span> RESTAURANTES SIN FRONTERAS - RSF. <span data-i18n="rights">Todos los derechos reservados.</span></footer>
<div id="login-modal" class="card hidden" style="position:fixed;right:20px;top:80px;max-width:260px;">
  <h4>Login </h4>
  <p class="small">Selecciona un rol:</p>
  <button onclick="quickLogin('DUEÑO')">Admin (DUEÑO)</button> <button onclick="quickLogin('EMPLEADO1')">Staff (EMPLEADO1)</button> <button onclick="quickLogin('user')">Usuario (user)</button>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="assets/app.js"></script>
<script>
document.addEventListener('DOMContentLoaded', async ()=>{
  document.getElementById('year').textContent = new Date().getFullYear();
  applyLang(); renderLogo(); await updateDashboard();
});
</script>
</body></html>
